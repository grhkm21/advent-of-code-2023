âŸ¨Split, SplitFâŸ© â† â€¢Import "util.bqn"
maps â† âŸ¨âŸ©SplitFâ€¢FLines"../input/in_2023_05"
orig â† â€¢ParseFloatÂ¨' 'SplitâŠ‘1â†“':'SplitâŠ‘âŠ‘maps
maps â†© {(Â¯1+1âŠğ•©)âŠ¸+âŒ¾(2âŠ¸âŠ)ğ•©}âŒ¾â‰Â¨{1(âŠâ‰1â‹âŠ¸âŠâŠ¢)âˆ˜â€¿3â¥Šâˆ¾(â€¢ParseFloatÂ¨)Â¨' 'SplitÂ¨1â†“ğ•©}Â¨1â†“maps

Follow â† {
  val â† ğ•©
  path â† âŸ¨âŸ©
  {
    val_start â† val
    added â† 0
    {
      idxâ€¿destâ€¿srcâ€¿end â† ğ•©
      (Â¬added) âˆ§ (srcâŠ¸â‰¤âˆ§endâŠ¸â‰¥) val_start ?
        # val âˆŠ [src, end] -> map val
        val â†© dest + (val - src)
        path â†© path âˆ¾ idx
        added â†© 1
      ; 0
    }Â¨(â†•â‰ ğ•©)âˆ¾Â¨(<Ë˜ğ•©)
    # If not added, then append â‰ ğ•© to path
    path â†© path âˆ¾ (Â¬added) â¥Š â‰ ğ•©
  }Â¨maps
  valâ‹ˆpath
}

G â† {
  max â† 10 â‹† 100
  BS â† {
    startâ€¿end â† ğ•©
    mid â† âŒŠ(start + end) Ã· 2
    val_startâ€¿path_start â† Follow start
    val_endâ€¿path_end â† Follow end
    {
      (path_start â‰¡ path_end) ? val_start ;
      (end = start + 1) ? (val_start âŒŠ val_end) ;
      (BS âŸ¨start, midâŸ©) âŒŠ BS âŸ¨mid, endâŸ©
    }
  }
  BS ğ•©
}
â€¢Show âŒŠÂ´âŠâ‰1âˆ˜â€¿2â¥Šâˆ¾FollowÂ¨orig
â€¢Show âŒŠÂ´GÂ¨{(Â¯1+âŠ‘ğ•©)âŠ¸+âŒ¾(1âŠ¸âŠ‘)ğ•©}Â¨<Ë˜âˆ˜â€¿2â¥Šorig
